import{V as k,m as d,s as n,g as h,h as y,c as p,l as F,a as C,b as w,A as P,d as A}from"./assets/validator-CLf5o44v.js";import{e as i,c as l,r as L,g as _}from"./assets/recaptcha-BkbUZVkf.js";import{a as I,m as N,c as S}from"./assets/content-square-sDGRM2KE.js";class x extends k{validate(){return this.resetErrors(),this.validateField("fullname",this.validateName,d.invalidName),this.validateField("email",this.validateEmail,d.invalidEmail),this.validateField("country"),this.validateField("marketing-source"),this.validateCheckbox("agreement",d.termsNotAccepted),Object.keys(this.errors).length===0}}function U(){const e=n.htmlElement(i.form.lead.id);if(!e||e.dataset.initialized==="true")return;if(e.dataset.initialized="true",h(l.keys.leadFormSubmitted)){y(e);return}const r=async c=>{c.preventDefault();const t=n.htmlElement(i.form.submit);if(!t||t.disabled)return;const m=t.value;try{if(t.disabled=!0,t.value=t.dataset.wait||"Submitting...",t.classList.add(p.button.loading),!new x(e).validate())return;const u=await L.validate(),o=h(l.keys.referralId),g=n.htmlElement(i.form.lead.name),f=n.htmlElement(i.form.lead.email),v=n.htmlElement(i.form.lead.country),b=n.htmlElement(i.form.lead.marketingSource);await F.createLead({fullName:g.value,email:f.value,countryCode:v.value,marketingSource:parseInt(b.value,10),hasAcceptedTermsAndPrivacy:!0,recaptchaToken:u,referralId:o}),C(l.keys.leadFormSubmitted,!0),_.trackEvent("new_leads","New patient lead submitted","Book"),I.trackEvent("new_patient_lead_submitted"),N.trackEvent("ConversionConsult",{fullName:g.value,email:f.value,countryCode:v.value}),y(e)}catch(s){console.error("Error creating lead:",s),w()}finally{t.value=m,t.classList.remove(p.button.loading),setTimeout(()=>{t.disabled=!1},1e3)}};e.addEventListener("submit",r)}class D{async getCountry(){const a=await fetch(l.geojs.apiUrl);if(!a.ok)throw new Error(`API Error: ${a.status}`);return a.json()}}const T=new D;class B extends P{async getAll(){return this.get("/payments/all-packages")}}const G=new B,R={formatters:{usd:new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}),gbp:new Intl.NumberFormat("en-GB",{style:"currency",currency:"GBP",minimumFractionDigits:0,maximumFractionDigits:0})}};function E(e){var r;const a=n.htmlElement(i.pricing.span);if(!a){console.error("Price label element not found");return}a.textContent=((r=a.textContent)==null?void 0:r.replace("{full_price_value}",e))||null}async function V(){try{const[{country:e},{packages:a}]=await Promise.all([T.getCountry(),G.getAll()]),r=e==="US",c=r?S.SERVICE_PACKAGE_FULL_DATAR:S.SERVICE_PACKAGE_FULL_TEMPUS,t=a.find(o=>o.isUsRegion===r&&o.servicePackage===c);if(!t)throw new Error("Service package not found for the current region");const{amount:m,currencyCode:s}=t.price,u=R.formatters[s.toLowerCase()].format(m);E(u)}catch(e){console.error("Error displaying package pricing info:",e),E("N/A")}}function j(){A(),V(),U()}document.addEventListener("DOMContentLoaded",j);
